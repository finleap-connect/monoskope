# ADR-3: Secret Management

## Context

Monoskope should provide functionality to let users manage secrets in upstream secret stores e.g. [Hashicorp Vault](https://www.vaultproject.io/).
**m8 itself won't store secrets**.

Uploading secrets has to be highly secure and m8 itself should not have access to the secrets or only for the short timeframe of storing it upstream.
Additionally we do not want to expose secrets to users, but show them a hash of it to make it comparable.

m8 should support multiple upstream secrets stores which will be implemented as different reactors which interact with them.

## Approaches

### Security #SEC1

* A one-time key pair generated by `monoctl` client-side will be used by `monoctl` to encrypt secrets client-side
* It uses a public key provided by m8 API to encrypt the secrets against
* The public key of the client-side key pair will be sent along with the encrypted secret for m8 to decrypt the secret for storage within the upstream secret store
* Reactor's have the private key to decrypt the secret payload to be able to store it upstream
* The public/private key pair of m8 will be rotated frequently to prevent that secrets are actually stored in m8 after they have been stored upstream

### API Design #APID1

* The API has different proto message types for different upstream secret providers to reflect differences between them
* Hashes have to be equal no matter what the upstream secret store is
* Secrets stores have to be activated/deactivated by system admins so that m8 can show a list of supported secret stores available along
* The first store added becomes the default store, this can be adjusted if there are more than one store
* Users have to provide which upstream store they target if they do not wan't the default store

## Decision

WHAT DO WE DO?

## Status

Proposed
